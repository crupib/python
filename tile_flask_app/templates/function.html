{% extends "base.html" %}
{% block content %}

{# Page banner color comes from the tile if provided #}
{% set banner = func.bg_color or "#8B0000" %}
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-xl-10">

      <!-- Header / Banner -->
      <div class="p-4 p-md-5 rounded-4 text-white d-flex align-items-center justify-content-between"
           style="background-color: {{ banner }};">
        <div class="d-flex align-items-center">
          <img
            src="{{ url_for('static', filename=(func.image or 'images/75th_main.jpeg')) }}"
            alt="{{ func.title }}"
            class="rounded me-3"
            style="width:84px;height:84px;object-fit:cover;"
          />
          <div>
            <h1 class="h2 mb-1">{{ func.title }}</h1>
            <p class="mb-0 opacity-75">{{ func.description }}</p>
          </div>
        </div>

        <a href="{{ url_for('index') }}" class="btn btn-outline-light d-none d-md-inline-flex">
          ← Back to Main
        </a>
      </div>

      <!-- Options as “Steps” -->
      <div class="mt-4">
        {% if not func.options %}
          <div class="alert alert-info mb-0">
            This function has no options yet.
          </div>
        {% else %}
          {% for o in func.options %}
          <div class="card shadow-sm rounded-4 mb-4 overflow-hidden">
            <!-- Step header bar -->
            <div class="px-4 py-2 d-flex align-items-center justify-content-between"
                 style="background:#1f1f1f;color:#fff;">
              <strong>Step {{ loop.index }}</strong>
              <span class="fw-semibold">{{ o.label or o.slug }}</span>
            </div>

            <!-- Body -->
            <div class="card-body">
              <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between">
                <div class="me-md-4 mb-3 mb-md-0">
                  <p class="mb-2 text-muted">
                    {{ o.description or "Run this action on the current system." }}
                  </p>
                </div>

                <div class="text-md-end">
                  <a
                    href="{{ url_for('option_page', slug=func.slug, opt_slug=o.slug) }}"
                    class="btn btn-primary btn-lg"
                  >
                    {{ o.button_text or (o.label or "Run") }}
                  </a>
                </div>
              </div>

              {# Optional helpers: show per-OS hint if the option defines commands #}
              {% if o.commands %}
              <hr class="my-4" />
              <div class="small text-muted">
                <span class="me-3">Runs per OS:</span>
                {% for os_key in ['linux','macos','windows'] if o.commands.get(os_key) %}
                  <span class="badge bg-light text-dark me-2">{{ os_key|capitalize }}</span>
                {% endfor %}
              </div>
              {% endif %}
            </div>
          </div>
          {% endfor %}
        {% endif %}
      </div>

      <!-- Back button on mobile -->
      <div class="d-grid d-md-none">
        <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
          ← Back to Main
        </a>
      </div>

    </div>
  </div>
</div>

{% endblock %}

